---
title: The LONGER you stride the HARDER you throw
format: html
execute:
    echo: false
---

<br>

### The Hypothesis
**Conventional baseball wisdom suggests that:**
The farther you stride the harder you will throw. Is that true?

```{r}
#| echo: false
#| warning: false
#| message: false

library(tidyverse)
library(plotly)

# 1. Load Data
df <- read_csv("data/pitcher_profiles.csv")

# 2. Calculate Stats
r_val <- cor(df$stride_length, df$pitch_speed_mph, use = "complete.obs")
avg_stride <- mean(df$stride_length, na.rm = TRUE)
avg_velo   <- mean(df$pitch_speed_mph, na.rm = TRUE)

# 3. Create the Professional Plot
p <- ggplot(df, aes(x = stride_length, y = pitch_speed_mph)) +
  
  # A. The Crosshairs (Quadrant Lines)
  geom_vline(xintercept = avg_stride, linetype="dotted", color="grey60") +
  geom_hline(yintercept = avg_velo, linetype="dotted", color="grey60") +
  
  # B. The Data Points (with Hover Text)
  geom_point(aes(text = paste("<b>Pitcher:</b>", user, 
                              "<br><b>Stride:</b>", round(stride_length, 2), "%",
                              "<br><b>Velo:</b>", pitch_speed_mph, "mph")), 
             color = "#2980b9", alpha = 0.7, size = 3) +
  
  # C. The Trend Line
  geom_smooth(method = "lm", color = "black", linetype = "dashed", se = FALSE) +
  
  # D. Labels & Theme
  labs(
    title = paste0("Stride Length vs. Velocity (r = ", round(r_val, 2), ")"),
    x = "Stride Length (% of Body Height)",
    y = "Velocity (MPH)"
  ) +
  theme_minimal() +
  theme(plot.title = element_text(face = "bold"))

# 4. Make it Interactive
ggplotly(p, tooltip = "text")
```

# Parameters of Research
<br>
Stride length is calculated from the rubber to the back of the front foot. It is shown as a percent of the athletes height. (0.7 = 70% of height)


```{r}
#| echo: false
#| fig.cap: "J. E. Manzi et al., 2022, Journal of Sports Sciences, 40(3)"
#| out.width: "80%"

knitr::include_graphics("stridelength.jpg")
```
<br>
<br>
<br>
